# Fungal-bacterial-network-construction-and-analysis

This repository contains code used to generate results for the manuscript "Fungal-Bacterial Cooccurrence Patterns Differ between Arbuscular Mycorrhizal Fungi and Nonmycorrhizal Fungi across Soil Niches".
Citation: Yuan MM, Kakouridis A, Starr E, Nguyen N, Shi S, Pett-Ridge J, Nuccio E, Zhou J, Firestone M. 2021. Fungal-bacterial cooccurrence patterns differ between arbuscularmycorrhizal fungi and nonmycorrhizal fungi across soil niches. mBio 12:e03509-20. https://doi.org/10.1128/mBio.03509-20.


Correlation cutoff determination through the random matrix theory (RMT)-based approach in this paper is available through the Molecular Ecological Network Analysis Pipeline (MENAP): http://ieg4.rccc.ou.edu/MENA/.


The folder <b>example_data</b> contains the 16S and ITS OTU tables for one of the networks presented in this paper (Season1, Week0), and a file containing a list of AMF OTUs. They are needed as the input files for the code 1.majority_cormatrix.R and 3.subnetwork.R. Input files for other pieces of code can be generated by running the code from 1 to 5 in order.

# Explanations for the code

- <b>1.majority_cormatrix.R</b> calculates the full correlation matrix for constructing the network from OTU tables.

- <b>2.cormatix_for_bipartite.R</b> modifies the full correlation matrix to generate a new correlation matrix for a bipartite network.

- <b>3.subnetwork.R</b> is to get subnetworks by removing certain nodes or keeping certain nodes.

- <b>4.analyze_network.R</b> calculates network topological features, node and link attributes, and generates input files for visualization using Cytoscape and Gephi.

- <b>5.random_bipartite_network.R</b> generates random bipartite networks that preserve the link and node numbers but rewire the links among nodes, then calculates the mean and standard deviation of network properties for multiple random networks.
